<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>üìÅ Folder Uploader with ZIP</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #e0e7ff;
      color: #1e293b;
      text-align: center;
      padding: 50px 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 20px;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 0;
    }
    p.subtitle {
      font-size: 1.1rem;
      color: #475569;
      margin-top: 0;
      margin-bottom: 30px;
    }
    input[type="file"] {
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #94a3b8;
      cursor: pointer;
      font-size: 1rem;
    }
    button {
      margin-top: 20px;
      padding: 14px 36px;
      font-size: 1.2rem;
      background: #4f46e5;
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: background 0.3s ease;
      user-select: none;
    }
    button:hover:not(:disabled) {
      background: #4338ca;
    }
    button:disabled {
      background: #a5b4fc;
      cursor: not-allowed;
    }
    #result {
      margin-top: 30px;
      font-size: 1.2rem;
      word-break: break-all;
      max-width: 600px;
      text-align: center;
    }
    a.download-link {
      color: #3730a3;
      font-weight: 600;
      text-decoration: none;
      border-bottom: 2px solid transparent;
      transition: border-bottom 0.3s ease;
    }
    a.download-link:hover {
      border-bottom: 2px solid #4338ca;
    }
  </style>
</head>
<body>
  <h1>üìÅ Upload a Folder & Get a ZIP Download Link</h1>
  <p class="subtitle">Select a folder to zip and upload it easily</p>
  
  <input type="file" id="fileInput" webkitdirectory directory multiple />
  <button id="uploadBtn" disabled>Upload Folder</button>
  
  <div id="result"></div>

  <!-- JSZip library CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  
  <script>
    const fileInput = document.getElementById('fileInput');
    const uploadBtn = document.getElementById('uploadBtn');
    const resultDiv = document.getElementById('result');

    fileInput.addEventListener('change', () => {
      uploadBtn.disabled = fileInput.files.length === 0;
      resultDiv.innerHTML = '';
    });

    uploadBtn.addEventListener('click', async () => {
      if (fileInput.files.length === 0) {
        alert('Please select a folder first!');
        return;
      }

      uploadBtn.disabled = true;
      resultDiv.textContent = 'üì¶ Creating ZIP file... Please wait.';

      const zip = new JSZip();

      // Add each file preserving folder structure
      for (const file of fileInput.files) {
        // file.webkitRelativePath includes folder path inside the selected folder
        zip.file(file.webkitRelativePath, file);
      }

      try {
        // Generate zip as blob
        const zipBlob = await zip.generateAsync({ type: 'blob' });
        resultDiv.textContent = 'üöÄ Uploading ZIP file...';

        // Prepare form data for upload
        const formData = new FormData();
        formData.append('file', zipBlob, 'folder.zip');

        // Upload to file.io
        const response = await fetch('https://file.io', {
          method: 'POST',
          body: formData
        });
        const data = await response.json();

        if (data.success) {
          resultDiv.innerHTML = `
            ‚úÖ Upload successful!<br>
            <a class="download-link" href="${data.link}" target="_blank" rel="noopener noreferrer">
              Download your ZIP here
            </a>
          `;
        } else {
          resultDiv.textContent = '‚ùå Upload failed: ' + (data.message || 'Unknown error');
        }
      } catch (error) {
        console.error(error);
        resultDiv.textContent = '‚ùå An error occurred during zip or upload.';
      } finally {
        uploadBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
