<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <title>üìÅ Zip & Upload Folder</title>
  <style>
    /* Reset & basics */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f4ff;
      color: #1e293b;
      display: flex;
      min-height: 100vh;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 20px;
    }
    header {
      width: 100%;
      max-width: 600px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }
    header h1 {
      font-weight: 700;
      font-size: 1.5rem;
      color: #3730a3;
      user-select: none;
    }
    nav button {
      background: transparent;
      border: none;
      font-weight: 600;
      color: #4f46e5;
      cursor: pointer;
      font-size: 1rem;
      padding: 8px 12px;
      border-radius: 6px;
      transition: background-color 0.2s ease;
    }
    nav button:hover, nav button.active {
      background-color: #c7d2fe;
    }

    main {
      background: white;
      padding: 25px 30px;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgb(79 70 229 / 0.1);
      width: 100%;
      max-width: 600px;
      min-height: 320px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* Home page styles */
    #home {
      display: flex;
      flex-direction: column;
      gap: 20px;
      text-align: center;
      color: #334155;
    }
    #home h2 {
      font-size: 1.8rem;
      font-weight: 600;
      margin-bottom: 5px;
    }
    #home p {
      font-size: 1.1rem;
      line-height: 1.4;
      user-select: none;
    }

    /* Upload page */
    #upload {
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      width: 100%;
    }
    #upload input[type="file"] {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #cbd5e1;
      cursor: pointer;
      font-size: 1rem;
    }
    #upload button {
      padding: 12px 36px;
      background: #4f46e5;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    #upload button:hover:not(:disabled) {
      background: #4338ca;
    }
    #upload button:disabled {
      background: #a5b4fc;
      cursor: not-allowed;
    }

    #result {
      font-size: 1rem;
      color: #334155;
      word-break: break-word;
      max-width: 100%;
      text-align: center;
    }
    #result a.download-link {
      color: #3730a3;
      font-weight: 600;
      text-decoration: none;
      border-bottom: 2px solid transparent;
      transition: border-bottom 0.3s ease;
    }
    #result a.download-link:hover {
      border-bottom: 2px solid #4338ca;
    }

    /* Responsive */
    @media (max-width: 480px) {
      main {
        padding: 20px;
        min-height: 300px;
      }
      header h1 {
        font-size: 1.3rem;
      }
      nav button {
        font-size: 0.9rem;
        padding: 6px 10px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>üìÅ Folder Uploader</h1>
    <nav>
      <button id="navHome" class="active">Home</button>
      <button id="navUpload">Upload</button>
    </nav>
  </header>

  <main>
    <!-- Home page -->
    <section id="home">
      <h2>Welcome!</h2>
      <p>Select the ‚ÄúUpload‚Äù tab to zip and upload your folder easily.</p>
      <p>This app zips your folder in the browser and uploads it as a single ZIP file.</p>
      <p>Works best in Chrome-based browsers.</p>
    </section>

    <!-- Upload page -->
    <section id="upload" aria-label="Upload Folder Section">
      <input type="file" id="fileInput" webkitdirectory directory multiple aria-label="Select folder" />
      <button id="uploadBtn" disabled>Upload Folder</button>
      <div id="result"></div>
    </section>
  </main>

  <!-- JSZip library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <script>
    // Navigation logic
    const navHome = document.getElementById('navHome');
    const navUpload = document.getElementById('navUpload');
    const homeSection = document.getElementById('home');
    const uploadSection = document.getElementById('upload');

    navHome.addEventListener('click', () => {
      homeSection.style.display = 'flex';
      uploadSection.style.display = 'none';
      navHome.classList.add('active');
      navUpload.classList.remove('active');
      clearResult();
    });

    navUpload.addEventListener('click', () => {
      homeSection.style.display = 'none';
      uploadSection.style.display = 'flex';
      navUpload.classList.add('active');
      navHome.classList.remove('active');
    });

    // Upload logic
    const fileInput = document.getElementById('fileInput');
    const uploadBtn = document.getElementById('uploadBtn');
    const resultDiv = document.getElementById('result');

    fileInput.addEventListener('change', () => {
      uploadBtn.disabled = fileInput.files.length === 0;
      clearResult();
    });

    uploadBtn.addEventListener('click', async () => {
      if (fileInput.files.length === 0) {
        alert('Please select a folder first!');
        return;
      }

      uploadBtn.disabled = true;
      setResult('üì¶ Creating ZIP file... Please wait.');

      const zip = new JSZip();

      for (const file of fileInput.files) {
        zip.file(file.webkitRelativePath, file);
      }

      try {
        const zipBlob = await zip.generateAsync({ type: 'blob' });
        setResult('üöÄ Uploading ZIP file...');

        const formData = new FormData();
        formData.append('file', zipBlob, 'folder.zip');

        const response = await fetch('https://file.io', {
          method: 'POST',
          body: formData,
        });

        if (!response.ok) {
          setResult(`‚ùå Upload failed: HTTP status ${response.status} ${response.statusText}`);
          uploadBtn.disabled = false;
          return;
        }

        const data = await response.json();

        if (data.success) {
          setResult(
            `‚úÖ Upload successful!<br>
            <a class="download-link" href="${data.link}" target="_blank" rel="noopener noreferrer">
              Download your ZIP here
            </a>`
          );
        } else {
          setResult('‚ùå Upload failed: ' + (data.message || 'Unknown error'));
        }
      } catch (error) {
        console.error('Upload error:', error);
        setResult(`‚ùå An error occurred during zip or upload: ${error.message}`);
      } finally {
        uploadBtn.disabled = false;
      }
    });

    function setResult(html) {
      resultDiv.innerHTML = html;
    }
    function clearResult() {
      resultDiv.innerHTML = '';
    }
  </script>
</body>
</html>
